/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x4bc4f3,_0x1ccfa9){switch(_0x4bc4f3){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x3f9f83){switch(_0x3f9f83){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x51fb68){this['navType']=_0x51fb68;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x2ef4af=this;axios['get']('user/count/1')['then'](function(_0x56951d){if(_0x56951d['data']['success']){console['log']('获取在线人数',_0x56951d['data']['result']);_0x2ef4af['chat']['userList']['onlineNum']=_0x56951d['data']['result'];}})['catch'](function(_0x31776e){_0x2ef4af['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x1469dd=this;axios['post']('user/list',{})['then'](function(_0x1c1f62){_0x1469dd['userList']['all']=_0x1c1f62['data']['result'];})['catch'](function(_0x50b3bb){console['log']('获取用户列表失败',_0x50b3bb);_0x1469dd['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0x4c8eec=this;var _0x3712bb={'onlineStatus':'1'};axios['post']('user/list',_0x3712bb)['then'](function(_0x157e2d){_0x4c8eec['chat']['userList']['onlineList']=_0x157e2d['data']['result'];})['catch'](function(_0x519a67){console['log']('获取用户列表失败',_0x519a67);_0x4c8eec['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x154356){var _0x2d066d=this;var _0x34688f={'current':0x1,'size':_0x154356};axios['post']('chat/page',_0x34688f)['then'](function(_0x53e8a5){if(_0x53e8a5['data']['result']&&_0x53e8a5['data']['result']['records']){_0x2d066d['chat']['message']['data']=_0x53e8a5['data']['result']['records']['reverse']();_0x2d066d['chat']['message']['data']['push'](_0x2d066d['chat']['message']['tip']);_0x2d066d['scrollToChatMessageBottom']();}})['catch'](function(_0x1aadc2){console['log'](_0x1aadc2);_0x2d066d['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x2bdc8d){if(/\.(png|jpg|jpeg)$/['test'](_0x2bdc8d)){return!![];}return![];},'previewFile':function(_0x1e1004){if(/\.(png|jpg|jpeg)$/['test'](_0x1e1004['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x1e1004['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0x26456b){console['log']('处理文件之前的校验',_0x26456b);var _0x3a3e1e=(0x3006e^0x3046e)*(0x59ea8^0x59aa8)*(0x83e96^0x83e5e);if(_0x26456b['size']>_0x3a3e1e){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x50fef7,_0x20b22d,_0x313074){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x50fef7);},'showChatSendFile':function(_0x11abfa){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x11abfa['result']['fileName'];this['chat']['sendFile']['fileId']=_0x11abfa['result']['fileId'];},'handleFileFail':function(_0x3b5d9c,_0x535b31,_0x116a00){this['chat']['loading']=![];this['$message']['error'](_0x3b5d9c['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x1e6422=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0x14b95e){console['log']('文件删除成功',_0x14b95e);_0x1e6422['clearSendFile']();_0x1e6422['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0x379ee3){console['log']('文件删除失败',_0x379ee3);_0x1e6422['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0x81468^0x81469;this['chat']['historyMessage']['size']=0x5f5c4^0x5f5ce;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x37662f=this;var _0x20281c={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x20281c)['then'](function(_0x5d8c6d){_0x37662f['chat']['historyMessage']['data']=_0x5d8c6d['data']['result']['records'];_0x37662f['chat']['historyMessage']['total']=_0x5d8c6d['data']['result']['total'];})['catch'](function(_0xb7cc77){console['log'](_0xb7cc77);_0x37662f['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0xc87c6^0xc87c7;this['chat']['historyMessage']['size']=0x5f15f^0x5f155;var _0x569873={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x53a35a=this;axios['post']('chat/page',_0x569873)['then'](function(_0x4694d5){_0x53a35a['chat']['historyMessage']['data']=_0x4694d5['data']['result']['records'];_0x53a35a['chat']['historyMessage']['total']=_0x4694d5['data']['result']['total'];})['catch'](function(_0x5695ec){console['log'](_0x5695ec);_0x53a35a['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x3193e5){this['chat']['historyMessage']['current']=0x4e265^0x4e264;this['chat']['historyMessage']['size']=_0x3193e5;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x598785){this['chat']['historyMessage']['current']=_0x598785;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x3a0b3d){var _0x468482=this;this['$refs'][_0x3a0b3d]['validate'](_0x278256=>{if(_0x278256){_0x468482['visible']['userDialog']=![];_0x468482['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x5989a2){var _0x192786=0xdd2cd^0xdd2cd;for(var _0xd676af=0x9db39^0x9db39;_0xd676af<_0x5989a2['length'];_0xd676af++){_0x192786=(0x1e8c7^0x1e8d8)*_0x192786+_0x5989a2['charCodeAt'](_0xd676af);}var _0x2a41e5=Math['abs'](_0x192786%this['chat']['colors']['length']);return this['chat']['colors'][_0x2a41e5];},'getAvatarStyle':function(_0x591427){var _0xd88540={};if(this['currentUser']['username']!=_0x591427['senderName']){_0xd88540['left']='10px';}else{_0xd88540['right']='10px';}_0xd88540['background-color']=this['getAvatarColor'](_0x591427['senderName']);return _0xd88540;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x3f1c43=this;this['timer']=setInterval(()=>{if(_0x3f1c43['maxFailNum']<(0x7976f^0x7976f)){_0x3f1c43['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x3f1c43['timer']);return;}if(_0x3f1c43['connectStatus']=='3'||_0x3f1c43['connectStatus']=='4'){_0x3f1c43['$message']('尝试断线重连');_0x3f1c43['connect'](_0x3f1c43['serverUrl']);}},0x1388);},'connect':function(_0x52ad7f){this['connectStatus']='1';let _0x138356=new SockJS(_0x52ad7f+'/ws');this['stompClient']=Stomp['over'](_0x138356);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0xe97636){let _0x8960a6=JSON['parse'](_0xe97636['body']);this['chat']['message']['data']['push'](_0x8960a6);this['scrollToChatMessageBottom']();},'onMessageOnline':function(_0x169fbd){this['chat']['userList']['onlineNum']=_0x169fbd['body'];},'scrollToChatMessageBottom':function(){var _0x58f423=this;this['$nextTick'](()=>{if(_0x58f423['$refs']['fd_chat_main']['scrollHeight']){_0x58f423['$refs']['fd_chat_main']['scrollTop']=_0x58f423['$refs']['fd_chat_main']['scrollHeight'];}},0x1dabb^0x1db4f);},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0x3a58fb={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0x3a58fb));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x34cb56){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-0x1;this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0x4f0195=window['location']['href'];if(_0x4f0195['lastIndexOf']('/')>0x0){return _0x4f0195['slice'](0xa36c3^0xa36c3,_0x4f0195['lastIndexOf']('/'));}return this['serverUrl']=_0x4f0195;},'getLoginUser':function(){var _0x9ee5c6=this;axios['get']('user/name')['then'](function(_0x11a3ca){if(_0x11a3ca['data']['success']){console['log']('获取登录用户成功',_0x11a3ca['data']['result']['username']);_0x9ee5c6['visible']['userDialog']=![];_0x9ee5c6['currentUser']=_0x11a3ca['data']['result'];_0x9ee5c6['initWebSocket']();}})['catch'](function(_0x51f482){console['log']('获取登录用户失败',_0x51f482);_0x9ee5c6['$message']('获取登录用户失败');});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});