/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'notification':null,'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'openNotice':![],'unread':0x0,'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x43e5f4,_0x218eba){switch(_0x43e5f4){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x4a6830){switch(_0x4a6830){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x5a8b3f){this['navType']=_0x5a8b3f;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'clearUnread':function(){this['chat']['unread']=0x4e9f0^0x4e9f0;},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x48d473=this;axios['get']('user/count/1')['then'](function(_0x53c276){if(_0x53c276['data']['success']){console['log']('获取在线人数',_0x53c276['data']['result']);_0x48d473['chat']['userList']['onlineNum']=_0x53c276['data']['result'];}})['catch'](function(_0x533130){_0x48d473['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x2d2aca=this;axios['post']('user/list',{})['then'](function(_0x599702){_0x2d2aca['userList']['all']=_0x599702['data']['result'];})['catch'](function(_0x59ebb3){console['log']('获取用户列表失败',_0x59ebb3);_0x2d2aca['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0x3457e4=this;var _0x2426b6={'onlineStatus':'1'};axios['post']('user/list',_0x2426b6)['then'](function(_0x44d858){_0x3457e4['chat']['userList']['onlineList']=_0x44d858['data']['result'];})['catch'](function(_0xc13733){console['log']('获取用户列表失败',_0xc13733);_0x3457e4['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x4a0e3f){var _0x5074da=this;var _0x418213={'current':0x1,'size':_0x4a0e3f};axios['post']('chat/page',_0x418213)['then'](function(_0x3501fd){if(_0x3501fd['data']['result']&&_0x3501fd['data']['result']['records']){_0x5074da['chat']['message']['data']=_0x3501fd['data']['result']['records']['reverse']();_0x5074da['chat']['message']['data']['push'](_0x5074da['chat']['message']['tip']);_0x5074da['scrollToChatMessageBottom']();}})['catch'](function(_0xf5c032){console['log'](_0xf5c032);_0x5074da['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x2477cc){if(/\.(png|jpg|jpeg)$/['test'](_0x2477cc)){return!![];}return![];},'previewFile':function(_0x11f212){if(/\.(png|jpg|jpeg)$/['test'](_0x11f212['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x11f212['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0x12d7ae){console['log']('处理文件之前的校验',_0x12d7ae);var _0x3b716a=(0x5ff78^0x5fb78)*(0x45f54^0x45b54)*(0x548f8^0x54830);if(_0x12d7ae['size']>_0x3b716a){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x5a8efc,_0x40d88c,_0x182b40){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x5a8efc);},'showChatSendFile':function(_0x18d3d8){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x18d3d8['result']['fileName'];this['chat']['sendFile']['fileId']=_0x18d3d8['result']['fileId'];},'handleFileFail':function(_0xc8cad8,_0x136e8e,_0x59f8fd){this['chat']['loading']=![];this['$message']['error'](_0xc8cad8['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x8c1469=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0xa9b087){console['log']('文件删除成功',_0xa9b087);_0x8c1469['clearSendFile']();_0x8c1469['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0x2df61f){console['log']('文件删除失败',_0x2df61f);_0x8c1469['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0xef415^0xef414;this['chat']['historyMessage']['size']=0xba9a3^0xba9a9;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x45a653=this;var _0x5802ab={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x5802ab)['then'](function(_0x582bad){_0x45a653['chat']['historyMessage']['data']=_0x582bad['data']['result']['records']['reverse']();_0x45a653['chat']['historyMessage']['total']=_0x582bad['data']['result']['total'];})['catch'](function(_0x4c2e81){console['log'](_0x4c2e81);_0x45a653['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0x923c8^0x923c9;this['chat']['historyMessage']['size']=0x3b246^0x3b24c;var _0x2d42b0={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x27a2ca=this;axios['post']('chat/page',_0x2d42b0)['then'](function(_0x48a82f){_0x27a2ca['chat']['historyMessage']['data']=_0x48a82f['data']['result']['records']['reverse']();_0x27a2ca['chat']['historyMessage']['total']=_0x48a82f['data']['result']['total'];})['catch'](function(_0x19f72f){console['log'](_0x19f72f);_0x27a2ca['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x48de93){this['chat']['historyMessage']['current']=0xacbe0^0xacbe1;this['chat']['historyMessage']['size']=_0x48de93;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x5ee09b){this['chat']['historyMessage']['current']=_0x5ee09b;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x259a0b){var _0xe154f=this;this['$refs'][_0x259a0b]['validate'](_0x34c26f=>{if(_0x34c26f){_0xe154f['visible']['userDialog']=![];_0xe154f['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x103113){var _0x31b8e2=0xdbfd7^0xdbfd7;for(var _0x12653e=0xc7d23^0xc7d23;_0x12653e<_0x103113['length'];_0x12653e++){_0x31b8e2=0x1f*_0x31b8e2+_0x103113['charCodeAt'](_0x12653e);}var _0x15ef6b=Math['abs'](_0x31b8e2%this['chat']['colors']['length']);return this['chat']['colors'][_0x15ef6b];},'getAvatarStyle':function(_0xd6207){var _0x701e67={};if(this['currentUser']['username']!=_0xd6207['senderName']){_0x701e67['left']='10px';}else{_0x701e67['right']='10px';}_0x701e67['background-color']=this['getAvatarColor'](_0xd6207['senderName']);return _0x701e67;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x35df9d=this;this['timer']=setInterval(()=>{if(_0x35df9d['maxFailNum']<0x0){_0x35df9d['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x35df9d['timer']);return;}if(_0x35df9d['connectStatus']=='3'||_0x35df9d['connectStatus']=='4'){_0x35df9d['$message']('尝试断线重连');_0x35df9d['connect'](_0x35df9d['serverUrl']);}},0x1388);},'connect':function(_0x361e1f){this['connectStatus']='1';let _0x4e9e1d=new SockJS(_0x361e1f+'/ws');this['stompClient']=Stomp['over'](_0x4e9e1d);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0x15ccaf){let _0x2c941e=JSON['parse'](_0x15ccaf['body']);if(_0x2c941e&&!this['chat']['openNotice']&&(_0x2c941e['type']=='2.1'||_0x2c941e['type']=='2.2')){this['scrollToChatMessageBottom']();return;}if(_0x2c941e&&_0x2c941e['type']=='1'){this['chat']['unread']=this['chat']['unread']+(0x3664f^0x3664e);}this['chat']['message']['data']['push'](_0x2c941e);this['scrollToChatMessageBottom']();this['noticeMessage']();},'onMessageOnline':function(_0x2e544c){this['chat']['userList']['onlineNum']=_0x2e544c['body'];},'scrollToChatMessageBottom':function(){var _0x45feb0=this;this['$nextTick'](()=>{if(_0x45feb0['$refs']['fd_chat_main']['scrollHeight']==_0x45feb0['$refs']['fd_chat_main']['scrollTop']){return;}if(_0x45feb0['$refs']['fd_chat_main']['scrollHeight']){_0x45feb0['$refs']['fd_chat_main']['scrollTop']=_0x45feb0['$refs']['fd_chat_main']['scrollHeight'];}},0x190);},'handlePaste':function(_0x2c348a){var _0x4d67e1=this;let _0x28b342=_0x2c348a['clipboardData']&&_0x2c348a['clipboardData']['items'];let _0x341c08=null;if(_0x28b342&&_0x28b342['length']){for(let _0x337d71=0x0;_0x337d71<_0x28b342['length'];_0x337d71++){if(_0x28b342[_0x337d71]['type']['indexOf']('image')!==-(0x6a3c0^0x6a3c1)){_0x341c08=_0x28b342[_0x337d71]['getAsFile']();break;}}}if(_0x341c08==null){return;}var _0x31e20d=new FileReader();_0x31e20d['onloadend']=function(_0x495a81){var _0x1149c2=_0x495a81['target']['result'];if(_0x1149c2=='data:'||_0x1149c2==''){return;}var _0x1f5386=_0x1149c2;var _0x58e8e2=_0x4d67e1['dataURItoBlob'](_0x1f5386);_0x4d67e1['uploadFile'](_0x58e8e2,'截图.png');};_0x31e20d['readAsDataURL'](_0x341c08);},'dataURItoBlob':function(_0x241c78){var _0x1212b4=_0x241c78['split'](',')[0x0]['split'](':')[0xb71dd^0xb71dc]['split'](';')[0x0];var _0x4be619=atob(_0x241c78['split'](',')[0x1]);var _0x5b7faa=new ArrayBuffer(_0x4be619['length']);var _0x5ab610=new Uint8Array(_0x5b7faa);for(var _0x23b40b=0x0;_0x23b40b<_0x4be619['length'];_0x23b40b++){_0x5ab610[_0x23b40b]=_0x4be619['charCodeAt'](_0x23b40b);}return new Blob([_0x5ab610],{'type':_0x1212b4});},'uploadFile':function(_0x5709b8,_0x2c8032){var _0x2fb4fa=new FormData();_0x2fb4fa['append']('file',_0x5709b8,_0x2c8032);var _0x24e582=this;axios['post']('file',_0x2fb4fa,{'headers':{'Content-Type':'multipart/form-data'}})['then'](function(_0x3e3725){_0x24e582['$message']('文件上传成功');_0x24e582['showChatSendFile'](_0x3e3725['data']);})['catch'](function(_0x130c71){_0x24e582['$message']('文件上传失败');});},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0x4d3505={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0x4d3505));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x14ccf5){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-(0x6eeed^0x6eeec);this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0xce04d3=window['location']['href'];if(_0xce04d3['lastIndexOf']('/')>0x0){return _0xce04d3['slice'](0x0,_0xce04d3['lastIndexOf']('/'));}return this['serverUrl']=_0xce04d3;},'getLoginUser':function(){var _0x4b5df2=this;axios['get']('user/name')['then'](function(_0x430b85){if(_0x430b85['data']['success']){console['log']('获取登录用户成功',_0x430b85['data']['result']['username']);_0x4b5df2['addWaterMark'](_0x430b85['data']['result']['username']);_0x4b5df2['visible']['userDialog']=![];_0x4b5df2['currentUser']=_0x430b85['data']['result'];_0x4b5df2['initWebSocket']();}})['catch'](function(_0x41cfc8){console['log']('获取登录用户失败',_0x41cfc8);_0x4b5df2['$message']('获取登录用户失败');});},'addWaterMark':function(_0x35849d){var _0x39adfe=document['body'];var _0x5ad92a='200px';var _0x29e95d='150px';var _0x49c49d='center';var _0x5ed1a2='top';var _0x147436='16px\x20Microsoft\x20Yahei';var _0xb3cd90='rgba(89,\x2091,\x2093,0.05)';var _0x47e515='30';var _0x3cb0e7=0x3e8;var _0xe0b072=document['createElement']('canvas');_0xe0b072['setAttribute']('width',_0x5ad92a);_0xe0b072['setAttribute']('height',_0x29e95d);var _0xf8f866=_0xe0b072['getContext']('2d');_0xf8f866['textAlign']=_0x49c49d;_0xf8f866['textBaseline']=_0x5ed1a2;_0xf8f866['font']=_0x147436;_0xf8f866['fillStyle']=_0xb3cd90;_0xf8f866['rotate'](Math['PI']/0xb4*_0x47e515);_0xf8f866['fillText'](_0x35849d,parseFloat(_0x5ad92a)/0x2,parseFloat(_0x29e95d)/(0x4e082^0x4e080));var _0x5abc8d=_0xe0b072['toDataURL']();const _0x5f51b0=document['createElement']('div');_0x5f51b0['setAttribute']('style','position:absolute;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20top:0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20left:0;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20height:100%;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20z-index:'+_0x3cb0e7+';\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20pointer-events:none;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-repeat:repeat;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20background-image:url(\x27'+_0x5abc8d+'\x27)');_0x39adfe['style']['position']='relative';_0x39adfe['insertBefore'](_0x5f51b0,_0x39adfe['firstChild']);},'noticeMessage':function(){var _0x149afa=this['chat']['unread'];var _0x874833=this;Notification['requestPermission']()['then'](function(_0x1c9682){if(_0x1c9682==='granted'){if(_0x874833['notification']&&_0x874833['notification']['close']){_0x874833['notification']['close']();}_0x874833['notification']=new Notification('消息提醒',{'body':'您有'+_0x149afa+'条未读消息'});}else if(_0x1c9682==='denied'){console['log']('用户拒绝通知');}});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});