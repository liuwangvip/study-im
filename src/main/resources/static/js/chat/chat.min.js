/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'unread':0x0,'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x12f091,_0x31cbae){switch(_0x12f091){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x7fd537){switch(_0x7fd537){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x4c7d2d){this['navType']=_0x4c7d2d;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'clearUnread':function(){this['chat']['unread']=0x6b413^0x6b413;},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x5a6654=this;axios['get']('user/count/1')['then'](function(_0x27cc1b){if(_0x27cc1b['data']['success']){console['log']('获取在线人数',_0x27cc1b['data']['result']);_0x5a6654['chat']['userList']['onlineNum']=_0x27cc1b['data']['result'];}})['catch'](function(_0x1d077a){_0x5a6654['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x13360f=this;axios['post']('user/list',{})['then'](function(_0x4c6296){_0x13360f['userList']['all']=_0x4c6296['data']['result'];})['catch'](function(_0x1ea1a2){console['log']('获取用户列表失败',_0x1ea1a2);_0x13360f['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0x5187c3=this;var _0x3b4d10={'onlineStatus':'1'};axios['post']('user/list',_0x3b4d10)['then'](function(_0xf5f033){_0x5187c3['chat']['userList']['onlineList']=_0xf5f033['data']['result'];})['catch'](function(_0x5bba36){console['log']('获取用户列表失败',_0x5bba36);_0x5187c3['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x4b625f){var _0x1f8ae8=this;var _0x1e46a6={'current':0x1,'size':_0x4b625f};axios['post']('chat/page',_0x1e46a6)['then'](function(_0xfa73ee){if(_0xfa73ee['data']['result']&&_0xfa73ee['data']['result']['records']){_0x1f8ae8['chat']['message']['data']=_0xfa73ee['data']['result']['records']['reverse']();_0x1f8ae8['chat']['message']['data']['push'](_0x1f8ae8['chat']['message']['tip']);_0x1f8ae8['scrollToChatMessageBottom']();}})['catch'](function(_0x3ebc08){console['log'](_0x3ebc08);_0x1f8ae8['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x401299){if(/\.(png|jpg|jpeg)$/['test'](_0x401299)){return!![];}return![];},'previewFile':function(_0x316f10){if(/\.(png|jpg|jpeg)$/['test'](_0x316f10['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x316f10['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0x121016){console['log']('处理文件之前的校验',_0x121016);var _0x3c9e46=(0x1f592^0x1f192)*(0xe1545^0xe1145)*(0x4cdfe^0x4cd36);if(_0x121016['size']>_0x3c9e46){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x25a2bf,_0x42c1ec,_0x3d1790){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x25a2bf);},'showChatSendFile':function(_0x4adc13){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x4adc13['result']['fileName'];this['chat']['sendFile']['fileId']=_0x4adc13['result']['fileId'];},'handleFileFail':function(_0x3ab40c,_0x57e39d,_0x26c5dc){this['chat']['loading']=![];this['$message']['error'](_0x3ab40c['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x489ce9=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0x34583d){console['log']('文件删除成功',_0x34583d);_0x489ce9['clearSendFile']();_0x489ce9['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0xd65778){console['log']('文件删除失败',_0xd65778);_0x489ce9['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0x9aa32^0x9aa33;this['chat']['historyMessage']['size']=0x2b3e2^0x2b3e8;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x2ba632=this;var _0x1ff623={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x1ff623)['then'](function(_0x16a1df){_0x2ba632['chat']['historyMessage']['data']=_0x16a1df['data']['result']['records'];_0x2ba632['chat']['historyMessage']['total']=_0x16a1df['data']['result']['total'];})['catch'](function(_0x1fd359){console['log'](_0x1fd359);_0x2ba632['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0x5ad40^0x5ad41;this['chat']['historyMessage']['size']=0x6f455^0x6f45f;var _0x1ef0de={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x3d812a=this;axios['post']('chat/page',_0x1ef0de)['then'](function(_0x55b31c){_0x3d812a['chat']['historyMessage']['data']=_0x55b31c['data']['result']['records'];_0x3d812a['chat']['historyMessage']['total']=_0x55b31c['data']['result']['total'];})['catch'](function(_0x352a67){console['log'](_0x352a67);_0x3d812a['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x598177){this['chat']['historyMessage']['current']=0x59a9f^0x59a9e;this['chat']['historyMessage']['size']=_0x598177;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x228e59){this['chat']['historyMessage']['current']=_0x228e59;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x4920e2){var _0x386647=this;this['$refs'][_0x4920e2]['validate'](_0x34b85b=>{if(_0x34b85b){_0x386647['visible']['userDialog']=![];_0x386647['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x375e24){var _0x2bf07b=0x1ac6d^0x1ac6d;for(var _0x935626=0x0;_0x935626<_0x375e24['length'];_0x935626++){_0x2bf07b=0x1f*_0x2bf07b+_0x375e24['charCodeAt'](_0x935626);}var _0x64a6a3=Math['abs'](_0x2bf07b%this['chat']['colors']['length']);return this['chat']['colors'][_0x64a6a3];},'getAvatarStyle':function(_0x38535f){var _0x159067={};if(this['currentUser']['username']!=_0x38535f['senderName']){_0x159067['left']='10px';}else{_0x159067['right']='10px';}_0x159067['background-color']=this['getAvatarColor'](_0x38535f['senderName']);return _0x159067;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x1073cb=this;this['timer']=setInterval(()=>{if(_0x1073cb['maxFailNum']<0x0){_0x1073cb['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x1073cb['timer']);return;}if(_0x1073cb['connectStatus']=='3'||_0x1073cb['connectStatus']=='4'){_0x1073cb['$message']('尝试断线重连');_0x1073cb['connect'](_0x1073cb['serverUrl']);}},0x1388);},'connect':function(_0x124839){this['connectStatus']='1';let _0x8e2bfe=new SockJS(_0x124839+'/ws');this['stompClient']=Stomp['over'](_0x8e2bfe);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0x7b60d5){let _0x4857de=JSON['parse'](_0x7b60d5['body']);if(_0x4857de&&_0x4857de['type']=='1'){this['chat']['unread']=this['chat']['unread']+(0x6c661^0x6c660);}this['chat']['message']['data']['push'](_0x4857de);this['scrollToChatMessageBottom']();},'onMessageOnline':function(_0x35b1b7){this['chat']['userList']['onlineNum']=_0x35b1b7['body'];},'scrollToChatMessageBottom':function(){var _0x1ce271=this;this['$nextTick'](()=>{if(_0x1ce271['$refs']['fd_chat_main']['scrollHeight']){_0x1ce271['$refs']['fd_chat_main']['scrollTop']=_0x1ce271['$refs']['fd_chat_main']['scrollHeight'];}},0x919d1^0x91825);},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0x532555={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0x532555));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x1b48ba){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-0x1;this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0x3691dc=window['location']['href'];if(_0x3691dc['lastIndexOf']('/')>0x0){return _0x3691dc['slice'](0x0,_0x3691dc['lastIndexOf']('/'));}return this['serverUrl']=_0x3691dc;},'getLoginUser':function(){var _0x160ee1=this;axios['get']('user/name')['then'](function(_0x2dbb5d){if(_0x2dbb5d['data']['success']){console['log']('获取登录用户成功',_0x2dbb5d['data']['result']['username']);_0x160ee1['visible']['userDialog']=![];_0x160ee1['currentUser']=_0x2dbb5d['data']['result'];_0x160ee1['initWebSocket']();}})['catch'](function(_0x382d2f){console['log']('获取登录用户失败',_0x382d2f);_0x160ee1['$message']('获取登录用户失败');});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});