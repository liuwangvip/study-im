/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'openNotice':![],'unread':0x0,'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x5539e7,_0x400867){switch(_0x5539e7){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x4d790d){switch(_0x4d790d){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x1866d9){this['navType']=_0x1866d9;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'clearUnread':function(){this['chat']['unread']=0x606ee^0x606ee;},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x61ac1e=this;axios['get']('user/count/1')['then'](function(_0x5d0d69){if(_0x5d0d69['data']['success']){console['log']('获取在线人数',_0x5d0d69['data']['result']);_0x61ac1e['chat']['userList']['onlineNum']=_0x5d0d69['data']['result'];}})['catch'](function(_0x544fe5){_0x61ac1e['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x2ca260=this;axios['post']('user/list',{})['then'](function(_0x550ecb){_0x2ca260['userList']['all']=_0x550ecb['data']['result'];})['catch'](function(_0x4be5f3){console['log']('获取用户列表失败',_0x4be5f3);_0x2ca260['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0x2949ac=this;var _0x3598b4={'onlineStatus':'1'};axios['post']('user/list',_0x3598b4)['then'](function(_0x388217){_0x2949ac['chat']['userList']['onlineList']=_0x388217['data']['result'];})['catch'](function(_0x2f73e1){console['log']('获取用户列表失败',_0x2f73e1);_0x2949ac['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x11b46b){var _0x2e43ef=this;var _0x1346fd={'current':0x1,'size':_0x11b46b};axios['post']('chat/page',_0x1346fd)['then'](function(_0x2649d3){if(_0x2649d3['data']['result']&&_0x2649d3['data']['result']['records']){_0x2e43ef['chat']['message']['data']=_0x2649d3['data']['result']['records']['reverse']();_0x2e43ef['chat']['message']['data']['push'](_0x2e43ef['chat']['message']['tip']);_0x2e43ef['scrollToChatMessageBottom']();}})['catch'](function(_0x411014){console['log'](_0x411014);_0x2e43ef['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x1ad708){if(/\.(png|jpg|jpeg)$/['test'](_0x1ad708)){return!![];}return![];},'previewFile':function(_0x97af03){if(/\.(png|jpg|jpeg)$/['test'](_0x97af03['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x97af03['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0x509183){console['log']('处理文件之前的校验',_0x509183);var _0x529733=(0x34e24^0x34a24)*(0xac195^0xac595)*(0x6b307^0x6b3cf);if(_0x509183['size']>_0x529733){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x57c5c4,_0x33cdab,_0x221071){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x57c5c4);},'showChatSendFile':function(_0x3aac2b){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x3aac2b['result']['fileName'];this['chat']['sendFile']['fileId']=_0x3aac2b['result']['fileId'];},'handleFileFail':function(_0x245d1a,_0x120e59,_0x14c0a7){this['chat']['loading']=![];this['$message']['error'](_0x245d1a['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x442723=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0xb5a73b){console['log']('文件删除成功',_0xb5a73b);_0x442723['clearSendFile']();_0x442723['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0x424776){console['log']('文件删除失败',_0x424776);_0x442723['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0xb95b2^0xb95b3;this['chat']['historyMessage']['size']=0x4bc56^0x4bc5c;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x5ed5ab=this;var _0x1ab5bb={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x1ab5bb)['then'](function(_0x4ce04d){_0x5ed5ab['chat']['historyMessage']['data']=_0x4ce04d['data']['result']['records'];_0x5ed5ab['chat']['historyMessage']['total']=_0x4ce04d['data']['result']['total'];})['catch'](function(_0x3873e3){console['log'](_0x3873e3);_0x5ed5ab['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0xa3bff^0xa3bfe;this['chat']['historyMessage']['size']=0x6aad5^0x6aadf;var _0x18714a={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x5c815f=this;axios['post']('chat/page',_0x18714a)['then'](function(_0x253b9f){_0x5c815f['chat']['historyMessage']['data']=_0x253b9f['data']['result']['records'];_0x5c815f['chat']['historyMessage']['total']=_0x253b9f['data']['result']['total'];})['catch'](function(_0x303829){console['log'](_0x303829);_0x5c815f['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x1bd20e){this['chat']['historyMessage']['current']=0x786db^0x786da;this['chat']['historyMessage']['size']=_0x1bd20e;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x59ad6){this['chat']['historyMessage']['current']=_0x59ad6;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x5eb78e){var _0x369767=this;this['$refs'][_0x5eb78e]['validate'](_0x2ae40f=>{if(_0x2ae40f){_0x369767['visible']['userDialog']=![];_0x369767['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x3d34eb){var _0x35ee09=0x46961^0x46961;for(var _0x29d459=0x0;_0x29d459<_0x3d34eb['length'];_0x29d459++){_0x35ee09=(0xe77a1^0xe77be)*_0x35ee09+_0x3d34eb['charCodeAt'](_0x29d459);}var _0x3d40eb=Math['abs'](_0x35ee09%this['chat']['colors']['length']);return this['chat']['colors'][_0x3d40eb];},'getAvatarStyle':function(_0x47e14d){var _0x49853d={};if(this['currentUser']['username']!=_0x47e14d['senderName']){_0x49853d['left']='10px';}else{_0x49853d['right']='10px';}_0x49853d['background-color']=this['getAvatarColor'](_0x47e14d['senderName']);return _0x49853d;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x1e88d8=this;this['timer']=setInterval(()=>{if(_0x1e88d8['maxFailNum']<(0xecb9b^0xecb9b)){_0x1e88d8['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x1e88d8['timer']);return;}if(_0x1e88d8['connectStatus']=='3'||_0x1e88d8['connectStatus']=='4'){_0x1e88d8['$message']('尝试断线重连');_0x1e88d8['connect'](_0x1e88d8['serverUrl']);}},0x3adf5^0x3be7d);},'connect':function(_0x4eef85){this['connectStatus']='1';let _0x3c8009=new SockJS(_0x4eef85+'/ws');this['stompClient']=Stomp['over'](_0x3c8009);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0x10c95d){let _0x283ec6=JSON['parse'](_0x10c95d['body']);if(_0x283ec6&&_0x283ec6['type']=='1'){this['chat']['unread']=this['chat']['unread']+0x1;}this['chat']['message']['data']['push'](_0x283ec6);this['scrollToChatMessageBottom']();},'onMessageOnline':function(_0x4b5bc3){this['chat']['userList']['onlineNum']=_0x4b5bc3['body'];},'scrollToChatMessageBottom':function(){var _0x215d08=this;this['$nextTick'](()=>{if(_0x215d08['$refs']['fd_chat_main']['scrollHeight']){_0x215d08['$refs']['fd_chat_main']['scrollTop']=_0x215d08['$refs']['fd_chat_main']['scrollHeight'];}},0x1f4);},'handlePaste':function(_0x515e95){var _0x2ce1e9=this;let _0x480380=_0x515e95['clipboardData']&&_0x515e95['clipboardData']['items'];let _0x2c8ba0=null;if(_0x480380&&_0x480380['length']){for(let _0x23101e=0x0;_0x23101e<_0x480380['length'];_0x23101e++){if(_0x480380[_0x23101e]['type']['indexOf']('image')!==-0x1){_0x2c8ba0=_0x480380[_0x23101e]['getAsFile']();break;}}}if(_0x2c8ba0==null){return;}var _0xa4eacb=new FileReader();_0xa4eacb['onloadend']=function(_0x57b653){var _0xc14ec3=_0x57b653['target']['result'];if(_0xc14ec3=='data:'||_0xc14ec3==''){return;}var _0x3081a0=_0xc14ec3;var _0x3c9c2c=_0x2ce1e9['dataURItoBlob'](_0x3081a0);_0x2ce1e9['uploadFile'](_0x3c9c2c,'截图.png');};_0xa4eacb['readAsDataURL'](_0x2c8ba0);},'dataURItoBlob':function(_0x2c8f9f){var _0x3e390a=_0x2c8f9f['split'](',')[0x0]['split'](':')[0x5bdf8^0x5bdf9]['split'](';')[0x0];var _0x4458ea=atob(_0x2c8f9f['split'](',')[0x8ce97^0x8ce96]);var _0x517e5a=new ArrayBuffer(_0x4458ea['length']);var _0x225ddb=new Uint8Array(_0x517e5a);for(var _0x13b28=0xe68da^0xe68da;_0x13b28<_0x4458ea['length'];_0x13b28++){_0x225ddb[_0x13b28]=_0x4458ea['charCodeAt'](_0x13b28);}return new Blob([_0x225ddb],{'type':_0x3e390a});},'uploadFile':function(_0x24e867,_0x54c709){var _0x2f9692=new FormData();_0x2f9692['append']('file',_0x24e867,_0x54c709);var _0x5c01e1=this;axios['post']('file',_0x2f9692,{'headers':{'Content-Type':'multipart/form-data'}})['then'](function(_0x57441e){_0x5c01e1['$message']('文件上传成功');_0x5c01e1['showChatSendFile'](_0x57441e['data']);})['catch'](function(_0xe754c3){_0x5c01e1['$message']('文件上传失败');});},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0xba40e2={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0xba40e2));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x13c5a8){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-(0x4c651^0x4c650);this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0x221ac0=window['location']['href'];if(_0x221ac0['lastIndexOf']('/')>0x0){return _0x221ac0['slice'](0xd9f76^0xd9f76,_0x221ac0['lastIndexOf']('/'));}return this['serverUrl']=_0x221ac0;},'getLoginUser':function(){var _0x1075d1=this;axios['get']('user/name')['then'](function(_0x54b997){if(_0x54b997['data']['success']){console['log']('获取登录用户成功',_0x54b997['data']['result']['username']);_0x1075d1['visible']['userDialog']=![];_0x1075d1['currentUser']=_0x54b997['data']['result'];_0x1075d1['initWebSocket']();}})['catch'](function(_0x4a3a63){console['log']('获取登录用户失败',_0x4a3a63);_0x1075d1['$message']('获取登录用户失败');});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});