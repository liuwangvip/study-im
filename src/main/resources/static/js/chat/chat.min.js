/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'unread':0x0,'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x460f5c,_0x27a01f){switch(_0x460f5c){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x26ddfb){switch(_0x26ddfb){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x198be2){this['navType']=_0x198be2;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'clearUnread':function(){this['chat']['unread']=0x3a9f5^0x3a9f5;},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x3d9443=this;axios['get']('user/count/1')['then'](function(_0x336e76){if(_0x336e76['data']['success']){console['log']('获取在线人数',_0x336e76['data']['result']);_0x3d9443['chat']['userList']['onlineNum']=_0x336e76['data']['result'];}})['catch'](function(_0x5ac718){_0x3d9443['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x3d3b79=this;axios['post']('user/list',{})['then'](function(_0x585781){_0x3d3b79['userList']['all']=_0x585781['data']['result'];})['catch'](function(_0x5c5279){console['log']('获取用户列表失败',_0x5c5279);_0x3d3b79['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0x39bc1c=this;var _0x975c23={'onlineStatus':'1'};axios['post']('user/list',_0x975c23)['then'](function(_0x2fecdd){_0x39bc1c['chat']['userList']['onlineList']=_0x2fecdd['data']['result'];})['catch'](function(_0x3e9ac9){console['log']('获取用户列表失败',_0x3e9ac9);_0x39bc1c['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x336a22){var _0x3bbaed=this;var _0x5024f1={'current':0x1,'size':_0x336a22};axios['post']('chat/page',_0x5024f1)['then'](function(_0x41416e){if(_0x41416e['data']['result']&&_0x41416e['data']['result']['records']){_0x3bbaed['chat']['message']['data']=_0x41416e['data']['result']['records']['reverse']();_0x3bbaed['chat']['message']['data']['push'](_0x3bbaed['chat']['message']['tip']);_0x3bbaed['scrollToChatMessageBottom']();}})['catch'](function(_0x26165c){console['log'](_0x26165c);_0x3bbaed['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x29c8a1){if(/\.(png|jpg|jpeg)$/['test'](_0x29c8a1)){return!![];}return![];},'previewFile':function(_0x3d696){if(/\.(png|jpg|jpeg)$/['test'](_0x3d696['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x3d696['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0xbc2533){console['log']('处理文件之前的校验',_0xbc2533);var _0x457cb8=(0xcbfe4^0xcbbe4)*(0x8ca71^0x8ce71)*(0xcf5d3^0xcf51b);if(_0xbc2533['size']>_0x457cb8){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x5004b2,_0x5cc49f,_0x497438){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x5004b2);},'showChatSendFile':function(_0x56db3c){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x56db3c['result']['fileName'];this['chat']['sendFile']['fileId']=_0x56db3c['result']['fileId'];},'handleFileFail':function(_0x291612,_0x448c09,_0x2e16cf){this['chat']['loading']=![];this['$message']['error'](_0x291612['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x53ad7a=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0x250861){console['log']('文件删除成功',_0x250861);_0x53ad7a['clearSendFile']();_0x53ad7a['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0x2c9d2b){console['log']('文件删除失败',_0x2c9d2b);_0x53ad7a['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0x24bc3^0x24bc2;this['chat']['historyMessage']['size']=0x626fc^0x626f6;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x242b69=this;var _0x52fdc7={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x52fdc7)['then'](function(_0xb8decb){_0x242b69['chat']['historyMessage']['data']=_0xb8decb['data']['result']['records'];_0x242b69['chat']['historyMessage']['total']=_0xb8decb['data']['result']['total'];})['catch'](function(_0x3ff2e1){console['log'](_0x3ff2e1);_0x242b69['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0xd110e^0xd110f;this['chat']['historyMessage']['size']=0x7e58d^0x7e587;var _0x53885f={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x413edc=this;axios['post']('chat/page',_0x53885f)['then'](function(_0x5eabda){_0x413edc['chat']['historyMessage']['data']=_0x5eabda['data']['result']['records'];_0x413edc['chat']['historyMessage']['total']=_0x5eabda['data']['result']['total'];})['catch'](function(_0x548658){console['log'](_0x548658);_0x413edc['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x57af39){this['chat']['historyMessage']['current']=0xb13d8^0xb13d9;this['chat']['historyMessage']['size']=_0x57af39;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x130c43){this['chat']['historyMessage']['current']=_0x130c43;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x54aa0a){var _0x487bbe=this;this['$refs'][_0x54aa0a]['validate'](_0x2eb4d9=>{if(_0x2eb4d9){_0x487bbe['visible']['userDialog']=![];_0x487bbe['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x1a805b){var _0x4786df=0xb3c6b^0xb3c6b;for(var _0x22a669=0x19d92^0x19d92;_0x22a669<_0x1a805b['length'];_0x22a669++){_0x4786df=(0x86a62^0x86a7d)*_0x4786df+_0x1a805b['charCodeAt'](_0x22a669);}var _0x2cf822=Math['abs'](_0x4786df%this['chat']['colors']['length']);return this['chat']['colors'][_0x2cf822];},'getAvatarStyle':function(_0x26a3c3){var _0x4f580b={};if(this['currentUser']['username']!=_0x26a3c3['senderName']){_0x4f580b['left']='10px';}else{_0x4f580b['right']='10px';}_0x4f580b['background-color']=this['getAvatarColor'](_0x26a3c3['senderName']);return _0x4f580b;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x8fbe3=this;this['timer']=setInterval(()=>{if(_0x8fbe3['maxFailNum']<(0xaf517^0xaf517)){_0x8fbe3['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x8fbe3['timer']);return;}if(_0x8fbe3['connectStatus']=='3'||_0x8fbe3['connectStatus']=='4'){_0x8fbe3['$message']('尝试断线重连');_0x8fbe3['connect'](_0x8fbe3['serverUrl']);}},0x1388);},'connect':function(_0x17d5d7){this['connectStatus']='1';let _0x27af2f=new SockJS(_0x17d5d7+'/ws');this['stompClient']=Stomp['over'](_0x27af2f);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0x3fa25f){let _0x4508af=JSON['parse'](_0x3fa25f['body']);if(_0x4508af&&_0x4508af['type']=='1'){this['chat']['unread']=this['chat']['unread']+0x1;}this['chat']['message']['data']['push'](_0x4508af);this['scrollToChatMessageBottom']();},'onMessageOnline':function(_0x1cd72f){this['chat']['userList']['onlineNum']=_0x1cd72f['body'];},'scrollToChatMessageBottom':function(){var _0x4f7301=this;this['$nextTick'](()=>{if(_0x4f7301['$refs']['fd_chat_main']['scrollHeight']){_0x4f7301['$refs']['fd_chat_main']['scrollTop']=_0x4f7301['$refs']['fd_chat_main']['scrollHeight'];}},0x1f4);},'handlePaste':function(_0x501e66){var _0x18e78d=this;let _0x83d8f=_0x501e66['clipboardData']&&_0x501e66['clipboardData']['items'];let _0xd5e502=null;if(_0x83d8f&&_0x83d8f['length']){for(let _0x146140=0x0;_0x146140<_0x83d8f['length'];_0x146140++){if(_0x83d8f[_0x146140]['type']['indexOf']('image')!==-0x1){_0xd5e502=_0x83d8f[_0x146140]['getAsFile']();break;}}}if(_0xd5e502==null){return;}var _0x4aa785=new FileReader();_0x4aa785['onloadend']=function(_0x25dd92){var _0x154796=_0x25dd92['target']['result'];if(_0x154796=='data:'||_0x154796==''){return;}var _0x4e20e=_0x154796;var _0x1f3d02=_0x18e78d['dataURItoBlob'](_0x4e20e);_0x18e78d['uploadFile'](_0x1f3d02,'截图.png');};_0x4aa785['readAsDataURL'](_0xd5e502);},'dataURItoBlob':function(_0x10b42e){var _0x5cac6b=_0x10b42e['split'](',')[0xd8d32^0xd8d32]['split'](':')[0x1]['split'](';')[0x830b4^0x830b4];var _0x28ea48=atob(_0x10b42e['split'](',')[0x1]);var _0x18540c=new ArrayBuffer(_0x28ea48['length']);var _0x12afa8=new Uint8Array(_0x18540c);for(var _0x31498f=0x0;_0x31498f<_0x28ea48['length'];_0x31498f++){_0x12afa8[_0x31498f]=_0x28ea48['charCodeAt'](_0x31498f);}return new Blob([_0x12afa8],{'type':_0x5cac6b});},'uploadFile':function(_0x52d3d4,_0xc9b9d0){var _0x38a0b0=new FormData();_0x38a0b0['append']('file',_0x52d3d4,_0xc9b9d0);var _0x455637=this;axios['post']('file',_0x38a0b0,{'headers':{'Content-Type':'multipart/form-data'}})['then'](function(_0x3ccb1b){_0x455637['$message']('文件上传成功');_0x455637['showChatSendFile'](_0x3ccb1b['data']);})['catch'](function(_0x367c6d){_0x455637['$message']('文件上传失败');});},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0x26e90f={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0x26e90f));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x5eed21){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-0x1;this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0xbafe9c=window['location']['href'];if(_0xbafe9c['lastIndexOf']('/')>0x0){return _0xbafe9c['slice'](0x0,_0xbafe9c['lastIndexOf']('/'));}return this['serverUrl']=_0xbafe9c;},'getLoginUser':function(){var _0x22558c=this;axios['get']('user/name')['then'](function(_0x500e9b){if(_0x500e9b['data']['success']){console['log']('获取登录用户成功',_0x500e9b['data']['result']['username']);_0x22558c['visible']['userDialog']=![];_0x22558c['currentUser']=_0x500e9b['data']['result'];_0x22558c['initWebSocket']();}})['catch'](function(_0x5c5161){console['log']('获取登录用户失败',_0x5c5161);_0x22558c['$message']('获取登录用户失败');});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});