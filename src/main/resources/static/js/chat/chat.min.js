/*Obfuscated by JShaman.com*/var vm=new Vue({'el':'#app','data':function(){return{'visible':{'userDialog':!![],'fileDialog':![],'showMoreDialog':![],'historyMessageDialog':![],'showPic':![]},'navType':'','roomList':{'searchText':'','data':[{'name':'群聊','src':'img/chat/chatroom.png'}]},'userList':{'searchText':'','all':[]},'currentUser':{'username':''},'rules':{'username':[{'required':!![],'message':'请输入用户名','trigger':'blur'}]},'stompClient':null,'timer':'','maxFailNum':0x5,'serverUrl':'','headers':{},'connectStatus':'','chat':{'loading':![],'loadingText':'','preview':{'pictureUrl':'','pdfUrl':''},'colors':['#2196F3','#32c787','#00BCD4','#ff5652','#ffc107','#ff85af','#FF9800','#39bbb0'],'message':{'tip':{'senderName':'超管','content':'用户行为规范：用户的言行不得违反《计算机信息网络国际联网安全保护管理办法》、《互联网信息服务管理办法》、《维护互联网安全的决定》、《互联网新闻信息服务管理规定》、《长江保护法》、《中华人民共和国测绘法》、《地图管理条例》、《网络安全法》、《未成年人保护法》、《互联网宗教信息服务管理办法》等相关法律法规规定；由于用户言行导致的法律问题与平台无关，平台保留追诉权力。','type':'1','createTime':moment()['format']('YYYY-MM-DD\x20HH:mm:ss')},'data':[]},'userList':{'searchText':'','onlineNum':0x0,'onlineList':[]},'searchHistoryMessageText':'','historyMessage':{'searchText':'','current':0x1,'size':0xa,'total':0x0,'data':[]},'msgContent':'','sendFile':{'disabled':![],'show':![],'fileName':'','fileId':''}}};},'watch':{'navType':function(_0x4aa7a5,_0x257715){switch(_0x4aa7a5){case'userList':this['loadUserList']();return;case'chatRoom':this['loadRoomList']();this['return'];}}},'methods':{'handleCommand'(_0x4a04da){switch(_0x4a04da){case'logout':window['location']['href']='logout';break;case'login':window['location']['href']='login';break;}},'openSetting':function(){this['$message']('开发中。。。');},'changeNav':function(_0x55d6ff){this['navType']=_0x55d6ff;},'login':function(){window['location']['href']=this['serverUrl']+'/login2';},'logout':function(){window['location']['href']='logout';},'searchChatRoom':function(){if(this['roomList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'searchUserList':function(){if(this['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'addUser':function(){this['$message']('开发中。。。');},'addChatRoom':function(){this['$message']('开发中。。。');},'loadRoomList':function(){},'loadOnlineUserCount':function(){var _0x38e21e=this;axios['get']('user/count/1')['then'](function(_0x1d8781){if(_0x1d8781['data']['success']){console['log']('获取在线人数',_0x1d8781['data']['result']);_0x38e21e['chat']['userList']['onlineNum']=_0x1d8781['data']['result'];}})['catch'](function(_0x3febab){_0x38e21e['$message']['error']('获取在线人数失败');});},'loadUserList':function(){var _0x310926=this;axios['post']('user/list',{})['then'](function(_0x321212){_0x310926['userList']['all']=_0x321212['data']['result'];})['catch'](function(_0x51a58f){console['log']('获取用户列表失败',_0x51a58f);_0x310926['$message']['error']('获取用户列表失败');});},'loadChatOnlineUserList':function(){var _0xe5e85e=this;var _0x2329ed={'onlineStatus':'1'};axios['post']('user/list',_0x2329ed)['then'](function(_0x120ab2){_0xe5e85e['chat']['userList']['onlineList']=_0x120ab2['data']['result'];})['catch'](function(_0x5d5fe7){console['log']('获取用户列表失败',_0x5d5fe7);_0xe5e85e['$message']['error']('获取用户列表失败');});},'searchChatUserList':function(){if(this['chat']['userList']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['$message']('开发中。。。');},'loadMessageList':function(_0x262f3c){var _0xc916ef=this;var _0x50efac={'current':0x1,'size':_0x262f3c};axios['post']('chat/page',_0x50efac)['then'](function(_0x506ee1){if(_0x506ee1['data']['result']&&_0x506ee1['data']['result']['records']){_0xc916ef['chat']['message']['data']=_0x506ee1['data']['result']['records']['reverse']();_0xc916ef['chat']['message']['data']['push'](_0xc916ef['chat']['message']['tip']);_0xc916ef['scrollToChatMessageBottom']();}})['catch'](function(_0x119a41){console['log'](_0x119a41);_0xc916ef['$message']['error']('获取最近消息失败');});},'canPreviewFile':function(_0x4e0880){if(/\.(png|jpg|jpeg)$/['test'](_0x4e0880)){return!![];}return![];},'previewFile':function(_0x44d423){if(/\.(png|jpg|jpeg)$/['test'](_0x44d423['fileName'])){this['visible']['showPic']=!![];this['chat']['preview']['pictureUrl']='file/'+_0x44d423['fileId'];return;}this['$message']('暂不支持该文件预览');},'openEmo':function(){this['$message']('开发中。。。');},'openFile':function(){this['visible']['fileDialog']=!![];},'checkUploadFile':function(_0x56db71){console['log']('处理文件之前的校验',_0x56db71);var _0x1f4026=(0xd9cf0^0xd98f0)*(0xa4cee^0xa48ee)*(0x2ac75^0x2acbd);if(_0x56db71['size']>_0x1f4026){this['$message']['error']('上传文件大小不能超过\x20200MB!');return![];}this['chat']['loading']=!![];this['chat']['loadingText']='文件上传中,请稍等';return!![];},'handleFileSuccess':function(_0x587bb7,_0xa98e4,_0x2fc9ca){this['chat']['loading']=![];this['$message']({'type':'success','message':'文件上传成功'});this['showChatSendFile'](_0x587bb7);},'showChatSendFile':function(_0x50c470){this['chat']['sendFile']['show']=!![];this['chat']['sendFile']['disabled']=!![];this['chat']['sendFile']['fileName']=_0x50c470['result']['fileName'];this['chat']['sendFile']['fileId']=_0x50c470['result']['fileId'];},'handleFileFail':function(_0x479095,_0x3f1e5c,_0x49e705){this['chat']['loading']=![];this['$message']['error'](_0x479095['message']||'文件上传失败，请联系管理员');},'deleteSendFile':function(){var _0x1916ed=this;axios['delete']('file/'+this['chat']['sendFile']['fileId'])['then'](function(_0x536a92){console['log']('文件删除成功',_0x536a92);_0x1916ed['clearSendFile']();_0x1916ed['$message']({'message':'文件删除成功','type':'success'});})['catch'](function(_0x3adc0b){console['log']('文件删除失败',_0x3adc0b);_0x1916ed['$message']['error']('文件删除失败，请联系管理员');});},'clearSendFile':function(){this['chat']['sendFile']['show']=![];this['chat']['sendFile']['disabled']=![];this['chat']['sendFile']['fileName']='';this['chat']['sendFile']['fileId']='';},'openMsgHistory':function(){this['visible']['historyMessageDialog']=!![];this['chat']['historyMessage']['current']=0x73e93^0x73e92;this['chat']['historyMessage']['size']=0x85b7d^0x85b77;this['chat']['historyMessage']['searchText']='';this['loadHistoryMessageList']();},'loadHistoryMessageList':function(){var _0x52b4d4=this;var _0x398daa={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};axios['post']('chat/page',_0x398daa)['then'](function(_0x5bc784){_0x52b4d4['chat']['historyMessage']['data']=_0x5bc784['data']['result']['records'];_0x52b4d4['chat']['historyMessage']['total']=_0x5bc784['data']['result']['total'];})['catch'](function(_0x31814d){console['log'](_0x31814d);_0x52b4d4['$message']['error']('获取历史消息失败');});},'searchHistoryMessage':function(){if(this['chat']['historyMessage']['searchText']==''){this['$message']('搜索内容不能为空');return;}this['chat']['historyMessage']['current']=0xca210^0xca211;this['chat']['historyMessage']['size']=0x7059d^0x70597;var _0x2ceb63={'current':this['chat']['historyMessage']['current'],'size':this['chat']['historyMessage']['size'],'searchText':this['chat']['historyMessage']['searchText']};var _0x5bf4ab=this;axios['post']('chat/page',_0x2ceb63)['then'](function(_0x211d67){_0x5bf4ab['chat']['historyMessage']['data']=_0x211d67['data']['result']['records'];_0x5bf4ab['chat']['historyMessage']['total']=_0x211d67['data']['result']['total'];})['catch'](function(_0x1dfdd4){console['log'](_0x1dfdd4);_0x5bf4ab['$message']['error']('获取历史消息失败');});},'handleHistoryMessageSizeChange'(_0x17cb08){this['chat']['historyMessage']['current']=0x98490^0x98491;this['chat']['historyMessage']['size']=_0x17cb08;this['loadHistoryMessageList']();},'handleHistoryMessagePageChange'(_0x1bf952){this['chat']['historyMessage']['current']=_0x1bf952;this['loadHistoryMessageList']();},'openVoiceChat':function(){this['$message']('开发中。。。');},'openVideoChat':function(){this['$message']('开发中。。。');},'showMore':function(){this['visible']['showMoreDialog']=!this['visible']['showMoreDialog'];if(this['visible']['showMoreDialog']){this['loadChatOnlineUserList']();}},'enterChat':function(_0x4a7ce2){var _0x586019=this;this['$refs'][_0x4a7ce2]['validate'](_0x40d3ba=>{if(_0x40d3ba){_0x586019['visible']['userDialog']=![];_0x586019['initWebSocket']();}else{this['$message']('用户名不能为空');return![];}});},'getAvatarColor':function(_0x529a15){var _0xbe4427=0xb8077^0xb8077;for(var _0x3117a6=0xf2afd^0xf2afd;_0x3117a6<_0x529a15['length'];_0x3117a6++){_0xbe4427=(0x80650^0x8064f)*_0xbe4427+_0x529a15['charCodeAt'](_0x3117a6);}var _0x4f864a=Math['abs'](_0xbe4427%this['chat']['colors']['length']);return this['chat']['colors'][_0x4f864a];},'getAvatarStyle':function(_0x5dea3b){var _0x531a0b={};if(this['currentUser']['username']!=_0x5dea3b['senderName']){_0x531a0b['left']='10px';}else{_0x531a0b['right']='10px';}_0x531a0b['background-color']=this['getAvatarColor'](_0x5dea3b['senderName']);return _0x531a0b;},'initWebSocket':function(){this['connect'](this['serverUrl']);let _0x5ae8f6=this;this['timer']=setInterval(()=>{if(_0x5ae8f6['maxFailNum']<0x0){_0x5ae8f6['$notify']['error']({'title':'提示','message':'尝试断线重连失败，已达最大失败次数','duration':0x0});clearInterval(_0x5ae8f6['timer']);return;}if(_0x5ae8f6['connectStatus']=='3'||_0x5ae8f6['connectStatus']=='4'){_0x5ae8f6['$message']('尝试断线重连');_0x5ae8f6['connect'](_0x5ae8f6['serverUrl']);}},0x45ac9^0x44941);},'connect':function(_0xbdd7db){this['connectStatus']='1';let _0xf3777b=new SockJS(_0xbdd7db+'/ws');this['stompClient']=Stomp['over'](_0xf3777b);this['headers']={};this['stompClient']['connect'](this['headers'],this['onConnectSuccess'],this['onConnectError']);},'onConnectSuccess':function(){this['maxFailNum']=0x5aa73^0x5aa76;this['connectStatus']='2';this['stompClient']['subscribe']('/topic/public',this['onMessageReceived']);this['stompClient']['subscribe']('/topic/online',this['onMessageOnline']);this['stompClient']['send']('/app/chat.online',this['headers'],JSON['stringify']({'senderName':this['currentUser']['username']}));},'onMessageReceived':function(_0x25f198){let _0x2bec3a=JSON['parse'](_0x25f198['body']);this['chat']['message']['data']['push'](_0x2bec3a);this['scrollToChatMessageBottom']();},'onMessageOnline':function(_0x154c3d){this['chat']['userList']['onlineNum']=_0x154c3d['body'];},'scrollToChatMessageBottom':function(){var _0x1fb259=this;this['$nextTick'](()=>{if(_0x1fb259['$refs']['fd_chat_main']['scrollHeight']){_0x1fb259['$refs']['fd_chat_main']['scrollTop']=_0x1fb259['$refs']['fd_chat_main']['scrollHeight'];}},0x1f4);},'sendMessage':function(){if(this['chat']['msgContent']==''&&this['chat']['sendFile']['fileId']==''){this['$notify']({'title':'提示','message':'消息内容不能为空','type':'warning'});return;}var _0x3816a0={'senderId':this['currentUser']['id'],'senderName':this['currentUser']['username'],'fileId':this['chat']['sendFile']['fileId'],'fileName':this['chat']['sendFile']['fileName'],'content':this['chat']['msgContent'],'type':'1'};this['stompClient']['send']('/app/public.sendMessage',this['headers'],JSON['stringify'](_0x3816a0));this['chat']['msgContent']='';this['clearSendFile']();},'sendFile':function(){this['$message']('开发中。。。');},'onConnectError':function(_0x5c07bd){this['connectStatus']='3';this['maxFailNum']=this['maxFailNum']-0x1;this['$notify']({'title':'提示','message':'连接服务器失败','type':'error'});},'disconnect':function(){if(this['stompClient']){this['stompClient']['disconnect']();this['connectStatus']='4';this['$notify']({'title':'提示','message':'断开连接','type':'info'});}},'getServerUrl':function(){let _0x1ec26c=window['location']['href'];if(_0x1ec26c['lastIndexOf']('/')>0x0){return _0x1ec26c['slice'](0x0,_0x1ec26c['lastIndexOf']('/'));}return this['serverUrl']=_0x1ec26c;},'getLoginUser':function(){var _0x5a39b1=this;axios['get']('user/name')['then'](function(_0x3ed4a1){if(_0x3ed4a1['data']['success']){console['log']('获取登录用户成功',_0x3ed4a1['data']['result']['username']);_0x5a39b1['visible']['userDialog']=![];_0x5a39b1['currentUser']=_0x3ed4a1['data']['result'];_0x5a39b1['initWebSocket']();}})['catch'](function(_0x4acf2d){});},'init':function(){this['getLoginUser']();this['loadMessageList']();this['navType']='chatRoom';this['serverUrl']=this['getServerUrl']();console['log']('服务器地址:'+this['serverUrl']);}},'mounted':function(){this['init']();},'beforeDestroy':function(){this['disconnect']();clearInterval(this['timer']);}});